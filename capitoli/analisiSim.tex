%Andrea Borghesi
%Università degli studi di Bologna

%capitolo dedicato all'analisi dei risultati delle simulazioni 

\documentclass[12pt,a4paper,openright,twoside]{report}
\usepackage[italian]{babel}
\usepackage{indentfirst}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{titlesec,blindtext, color}
\usepackage[font={small,it}]{caption}
\usepackage{subfig}
\usepackage{listings}
\usepackage{color}
\usepackage{url}
\usepackage{textcomp}

%impostazioni generali per visualizzare codice
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
 
\lstset{ %
  basicstyle=\footnotesize,           % the size of the fonts that are used for the code
  backgroundcolor=\color{white},      % choose the background color. You must add \usepackage{color}
  numbers=left,                   % where to put the line-numbers
  numberstyle=\tiny\color{gray},  % the style that is used for the line-numbers
  numbersep=5pt,  
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  rulecolor=\color{black}, 
  tabsize=2,                      % sets default tabsize to 2 spaces
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  title=\lstname,                   % show the filename of files included with \lstinputlisting;
  frame=single,                   % adds a frame around the code
                                  % also try caption instead of title
  keywordstyle=\color{blue},          % keyword style
  commentstyle=\color{dkgreen},       % comment style
  stringstyle=\color{mauve},         % string literal style
  escapeinside={\%*}{*)},            % if you want to add LaTeX within your code
  morekeywords={*,...},              % if you want to add more keywords to the set
  deletekeywords={...}              % if you want to delete keywords from the given language
}

%per avere un bordo intorno alle figure
\usepackage{float}
\floatstyle{boxed} 
\restylefloat{figure}

%per poter poi impedire che certe parole vadano a capo
\usepackage{hyphenat}
\usepackage{listings}

%ridefinisco font per fancyhdr, per ottenere un'intestazione pulita
\newcommand{\changefont}{ \fontsize{9}{11}\selectfont }
\fancyhf{}
\fancyhead[LE,RO]{\changefont \slshape \rightmark} 	%section
\fancyhead[RE,LO]{\changefont \slshape \leftmark}	%chapter
\fancyfoot[C]{\changefont \thepage}					%footer

%titolo capitolo con "numero | titolo"
\definecolor{gray75}{gray}{0.75}
\newcommand{\hsp}{\hspace{20pt}}
\titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\Huge\bfseries}


\oddsidemargin=30pt \evensidemargin=20pt

%sillabazioni non eseguite correttamente
\hyphenation{sil-la-ba-zio-ne pa-ren-te-si si-mu-la-to-re ge-ne-ra-re pia-no}

%interlinea
\linespread{1.15}  
\pagestyle{fancy}

%cartelle contenenti le immagini
\graphicspath{{/media/sda4/tesi/immagini/grafici/}{/media/sda4/tesi/immagini/grafici/incCompare/}{/media/sda4/tesi/immagini/grafici/rawData/}{/media/sda4/tesi/immagini/grafici/regressionAnalysis/}{/media/sda4/tesi/immagini/schemi/}{/media/sda4/tesi/immagini/simulazione/}{/media/sda4/tesi/immagini/epolicy/}}

%in modo che dopo il titolo di un paragrafo il testo vada a capo
\newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\}

\begin{document}
\chapter{RISULTATI SIMULAZIONI}

Nel capitolo precedente abbiamo descritto il modello ad agenti implementato, evidenziandone le finalità e le caratteristiche fondamentali, accennando brevemente alle informazioni ricavabili dal simulatore.\\*
Lo scopo di questo capitolo sarà quindi la dettagliata analisi dei dati prodotti dalle simulazioni, l'individuazione delle relazioni che legano le grandezze in gioco all'interno dell'ambiente simulato, la presentazione e discussione dei risultati ottenuti.\\*
Inizialmente presenteremo gli strumenti utilizzati per effettuare l'analisi sopra descritta, per poi passare alla discussione vera e propria nei paragrafi successivi.

\section{STRUMENTI}
Per esaminare i dati prodotti dalle simulazioni effettuate e visualizzare i risultati ottenuti abbiamo utilizzato \emph{R} \cite{Rlanguage}, un ambiente di sviluppo specifico per l'analisi statistica dei dati, basato sull'omonimo linguaggio di programmazione.

\subsection{R}

R è un linguaggio di programmazione open source e un ambiente software usato per la manipolazione di dati, calcolo e analisi statistica e presentazione grafica dei risultati. Il design di R è stato ampiamente influenzato da due linguaggi preesistenti, S sviluppato da J.Chambers e colleghi presso i Bell Laboratories negli anni '70 e Scheme creato presso il MIT AI Lab sempre negli anni settanta da G.L.Steele e G.J.Sussman. \\*
Il nucleo di R consiste di un linguaggio interpretato a cui sono state aggiunte numerose funzionalità per un grande numero di procedure statistiche;  tra queste è possibile ricordarne alcune: modelli di regressione lineare, lineare generalizzata e non lineare, analisi di serie temporali, classici test parametrici e non, clustering, classificazione e altre. R è facilmente estendibile grazie alla presenza di numerosi pacchetti software creati dagli utenti e dedicati a specifiche aree di studio e possiede inoltre un grande insieme di funzioni indicate per una presentazione flessibile ed efficiente dei dati e la produzione di grafici di qualità.\\*
Per interagire con l'interprete del linguaggio R è possibile fornire le istruzioni direttamente da riga di comando oppure appoggiarsi a interfacce grafiche, ma per le nostre necessità è stato sufficiente utilizzare la riga di comando.\\* \\* 
Per via della sua derivazione da S, R presenta alcune caratteristiche che lo fanno rientrare all'interno del paradigma dei linguaggi Object Oriented, almeno parzialmente, e al tempo stesso possiede alcuni aspetti che lo avvicinano alla natura dei linguaggi funzionali(come Scheme), come ad esempio la possibilità di trattare le funzioni stesse come oggetti.\\* Le principali strutture dati sono le seguenti: \begin{itemize}
\item \emph{vettori}, singole entità costituite da una collezione di valori di un certo tipo come ad esempio numerici,logici o caratteri;
\item \emph{matrici (arrays)}, generalizzazioni multi-dimensionali di vettori;
\item \emph{liste}, forme di vettori più generali nelle quali gli elementi non devono necessariamente essere dello stesso tipo;
\item \emph{fattori}, oggetti simili ai vettori usati per specificare una classificazione (raggruppamento) delle componenti di altri vettori con la stessa lunghezza;
\item \emph{data frames}, strutture simili alle matrici in cui le colonne possono essere di tipi diversi;
\item \emph{funzioni}, le quali sono esse stesse oggetti e forniscono così un modo semplice e flessibile di estendere R.
\end{itemize}
Come in ogni linguaggio di programmazione è poi ovviamente possibile manipolare queste strutture dati attraverso operatori, strutture di controllo, funzioni, etc.\\* \\*
Illustreremo ora un brevissimo esempio per far capire un possibile utilizzo di R per effettuare una semplice analisi statistica. Supponiamo di voler studiare la relazione che lega due variabili, \emph{a} e \emph{b}, i cui valori si trovano in un file di tipo \emph{Comma Separated Values}. Il primo passo è importare tali valori dal file e inserirli in una struttura dati, in questo caso una matrice con due colonne (una per ogni variabile) e ordinarli in base ai valori della prima variabile.

\lstset{language=R}
\begin{lstlisting}
> matrice.dati <- read.csv("file.csv")
> matrice.ordinata <- matrice_dati[order(matrice.dati$a),]
\end{lstlisting}

A questo punto sarebbe possibile svolgere diverse operazioni sui dati (ad esempio calcolare per ogni valore di ogni variabile i valori medi,...) ma ci limiteremo a effettuare una semplice regressione lineare.
\begin{lstlisting}
> modello.lineare <- lm(matrice$b ~ matrice$a)
\end{lstlisting}

R ci consente ora di effettuare analisi statistiche sul modello di regressione applicato per stabilirne validità e significatività in rapporto ai dati in nostro possesso e successivamente di presentare graficamente i risultati ottenuti.
\begin{lstlisting}
> # analisi statistica minima
> summary(modello.lineare)       
> # disegna i punti corrispondenti ai valori nella matrice
> plot(matrice$b ~ matrice$a,type="p",lwd=3,ylab="b",xlab="a")    
> # disegna la curva di regressione
> lines(matrice$a,predict(modello.lineare), lty="solid", col="darkred", lwd=2)    
\end{lstlisting}


In Figura ~\ref{example_r} sono stati riportati il grafico prodotto da questo esempio e i risultati ottenuti dalla semplicissima analisi statistica, tra i quali notiamo il coefficiente di determinazione (R-squared) e l'errore residuo (
Residual standard error).

\begin{figure}[H]
	\centering
	\subfloat[Grafico]{\includegraphics[scale=0.4]{example_r_graph}\label{example_r_graph}} 
	\quad
	\subfloat[Analisi statistica]{\includegraphics[scale=0.6]{example_r_result}\label{example_r_result}}
	\caption{Esempio di utilizzo di R}
	\label{example_r}
\end{figure}


\section{METODOLOGIA ANALITICA}

Illustreremo ora con quali metodi sono stati analizzati i dati ricavati dalle simulazioni; questo comporta anche una rapida descrizione delle tecniche statistiche impiegate e della loro applicazione nel nostro contesto.

\subsection{ANALISI DI REGRESSIONE}
Una delle tecniche statistiche maggiormente utilizzate per stimare le relazioni tra variabili è l'\emph{analisi della regressione}; in questa categoria rientrano diversi metodi che hanno come obiettivo quello di trovare un modello che leghi una variabile dipendente ed una o più variabili indipendenti (in particolare l'analisi della regressione consente di capire come cambia il valore di una variabile dipendente al variare del valore di una variabile indipendente, mantenendo fisse le restanti); seguendo la terminologia di uso comune in seguito le variabili indipendenti saranno chiamate anche \emph{predittori}.  
I modelli con i quali si tenta di approssimare le relazioni studiate possono essere di numerosi tipi, tra i quali è possibile ricordare quelli parametrici (come la regressione lineare e più in generale tutte le forme di regressione polinomiale), nei quali la funzione di regressione è definita attraverso un certo numero di parametri stimati a partire dai dati, e quelli non parametrici, poi ancora modelli locali (regressione LOESS), Bayesiani, segmentati, etc..\\*
In genere la scelta del giusto modello da applicare ai propri dati è un procedimento empirico che prevede di tentare differenti tecniche di regressione sulla stessa serie di dati per poi valutare quale fosse la scelta migliore, ovvero quale sia il modello di regressione che presenta la maggiore bontà di adattamento (in inglese ''goodness of fit''), cioè una misura che riassume la discrepanza tra i valori osservati e i valori attesi sotto il modello in questione. 
Una volta scelto il modello migliore, questo può essere usato per fare predizioni, comprendere in che modo in che modo certe variabili o aspetti di un problema ne influenzino altri, essere integrato all'interno di un sistema informatico attraverso tecniche di apprendimento automatico (come sarà mostrato nel prosieguo d questa trattazione). 
\\*\\*
Un aspetto di grande importanza è quindi la validazione del modello, valutare cioè se è in accordo con i dati presi in esame. Tra i diversi metodi di validazione possibili alcuni prevedono metodi numerici, come ad esempio il calcolo del coefficiente di determinazione, altri richiedono l'uso di tecniche più qualitative, ad esempio l'analisi grafica dei valori residuali; in genere per effettuare una validazione completa e affidabile vengono impiegate tecniche appartenenti ad entrambe le categorie ed anche in questo lavoro abbiamo agito in questo modo.\\*\\*
Uno dei principali indicatori numerici usati per valutare la bontà di un modello di regressione è il calcolo del \emph{coefficiente di determinazione}, o $R^2$, un numero reale compreso tra 0 e 1 che misura la proporzione di variabilità della risposta dovuta al modello statistico; un valore vicino a 0 indica che la regressione scelta non si adatta ai dati, viceversa valori vicini a 1 indicano che il modello è buono. \\*
Un indicatore utile per giudicare se la regressione effettuata abbia significato dal punto di vista statistico è il  \emph{valore p} (\emph{p-value} in inglese), il quale viene in genere confrontato con il livello di significatività fissato (in genere indicato con la lettera $\alpha$ e con valori in genere tra 0.05 e 0.001); se il p-value risulta essere minore di $\alpha$ la regressione può essere considerata statisticamente significativa.\\*
Un altro metodo utilizzato per verificare la bontà della regressione effettuata, oltre che per altri diversi scopi, è cosiddetto il \emph{F-test}, che, molto brevemente, consente di valutare se la regressione abbia significatività statistica calcolando un valore associatole e confrontandolo con un valore critico di una particolare distribuzione di probabilità chiamata  distribuzione di Fisher-Snedecor, o \emph{F-distribution} (questo test è utile anche per confrontare tra loro diversi modelli di regressione applicati alle stesse serie di dati).\\*\\*
In genere i metodi numerici da soli non sono ritenuti sufficienti per stabilire la validità di un modello di regressione, in quanto tendono a concentrarsi troppo solamente su alcuni aspetti del rapporto tra modello e dati, tentando di comprimere quelle informazioni in un singolo numero o risultato di un test. Per questo motivo in genere  tali metodi vengono spesso affiancati da tecniche di tipo più qualitativo, con le quali è possibile stimare la bontà di adattamento di una regressione osservando determinati grafici relativi a certe caratteristiche del modello di regressione da valutare.\\*
Lo strumento primario per stabilire se un modello di regressione approssima in maniera significativa una serie di dati è il \emph{grafico di dispersione} (in inglese \emph{scatter-plot}) relativo alla distribuzione dei \emph{residuali} rispetto alla variabile usata come predittore. Col termine residuali di un modello si intendono le differenze
tra la risposta osservata (il valore della variabile dipendente) e la risposta prevista (stimata tramite regressione) per ogni valore della variabile indipendente appartenente al campione di dati. Se il modello si adattasse correttamente ai dati, allora i residuali approssimerebbero gli errori casuali che rendono la relazione tra variabile dipendente e indipendente una relazione statistica, quindi, in sostanza, se i residuali presentano un comportamento casuale, osservabile attraverso i grafici di dispersione, questo suggerisce che il modello abbia un buon adattamento ai dati; se viceversa fosse evidente una struttura non casuale nella distribuzione dei residuali, questo sarebbe un chiaro segnale che il modello non è una buona approssimazione.\\*
Un altro aspetto che è possibile valutare attraverso metodi grafici è se valga o meno \emph{l'assunzione di normalità}, ovvero stabilire se è lecito aspettarsi che gli errori casuali inerenti al processo statistico modellato con la regressione seguano una distribuzione normale; questa assunzione viene generalmente fatta perché spesso una distribuzione normale descrive in maniera ragionevolmente accurata la distribuzione effettiva degli errori casuali di serie di dati nel mondo reale. Per controllare quindi se l'assunzione di normalità della serie di dati sia valida (e potendo poi effettuare previsioni corrette tramite la regressione) vengono utilizzati i \emph{grafici di probabilità normale}, costruiti tracciando i valori ordinati dei residuali e confrontandoli con i valori di una distribuzione  normale standard; se i punti tracciati sul piano associati ai residuali giacciono vicini alla linea determinata dalla distribuzione normale, allora si può affermare che gli errori casuali seguono una distribuzione normale.


\subsection{IMPLEMENTAZIONE IN R}

Per studiare le relazioni di nostro interesse la metodologia scelta consiste nell'aver effettuato un grande numero di simulazioni controllate (ovvero fissando tutti i parametri non rilevanti e variando quelli di cui osservare il comportamento, come il budget regionale o il tipo di incentivo), dopodiché abbiamo effettuato un'analisi statistica dei dati e tentato di risalire alle curve relative all'andamento delle relazioni attraverso l'uso di tecniche di regressione lineare e non.\\*
Per effettuare l'analisi della regressione nel nostro caso, il primo passo è consistito nello scegliere le variabili di cui studiare la relazione; per ogni tipologia di incentivazione sono stati considerati tre casi (riportati in seguito in maniera estesa):
\begin{itemize}
\item relazione tra il budget che la regione dedica agli incentivi (variabile indipendente) e produzione energetica da impianti fotovoltaici (variabile dipendente);
\item relazione tra la sensibilità degli agenti simulati all'influenza dell'interazione sociale e la produzione energetica (variabile dipendente);
\item relazione tra il raggio dell'interazione sociale, predittore, e produzione energetica da fotovoltaico.
\end{itemize}

Spiegheremo ora in che modo siano state implementate le tecniche di regressione statistica e di verifica dei modelli all'interno dell'ambiente fornito da R (i frammento di codice mostrati sono relativi allo studio della relazione tra budget e produzione energetica, ma il modo di gestire le restanti relazione è stato assolutamente analogo).\\*\\*
I dati di nostro interesse generati dal simulatore sono serie di coppie di valori budget-produzione elettrica (facilmente rappresentabili in un grafico), vengono letti da file, inseriti in una matrice e ordinati. Dal momento che a causa degli elementi di casualità presenti nel simulatore i dati grezzi presentano un discreto rumore (una non trascurabile variabilità della produzione energetica a fronte degli stessi valori di budget) abbiamo calcolato la media della produzione energetica per ogni valore di budget, ottenendo i dati più puliti con cui tentare la regressione.

\begin{lstlisting}
>data.unsorted <- read.csv(nome_file)
># dati grezzi ordinati sul valore di budget
> data <- data.unsorted[order(data.unsorted$Budget),]
># aggdata rappresenta la matrice contenente le coppie costituite dal valore di Budget e relativo valore medio di produzione energetica (Out)
> aggdata <- tapply(data$Out,data$Budget,mean)
> aggdata <- as.data.frame(aggdata)  
> head(aggdata)
> aggdata$Budget <- seq(from=0, to=(length(aggdata[,1]))-1, 1)
\end{lstlisting}
 
Abbiamo tentato con diversi tipi di regressione, a partire dalla versione più semplice ovvero la lineare \cite{robustLinearRegression}(con la quale cerchiamo di fare previsione con una funzione lineare della variabile indipendente), fino a modelli più complessi come quella polinomiale \cite{Gergonne1974439,Stigler1974431} o ancora la cosiddetta regressione locale, o LOESS \cite{lowess}(la quale procede adattando modelli polinomiali di basso grado a sottoinsiemi locali della serie di dati, in pratica costruendo punto per punto la funzione di previsione); per i diversi modelli sono poi stati calcolati la bontà di adattamento ai dati sfruttando le informazioni quantitative fornite da R.

\begin{lstlisting}
> #modello lineare
> linearModelAgg <- lm(aggdata$Out ~ aggdata$Budget)
> # modello quadratico
> quadraticModelAgg <- lm(aggdata$Out ~ poly(aggdata$Budget, 2, raw=TRUE))
> # modello cubico
> cubicModelAgg <- lm(aggdata$Out ~ poly(aggdata$Budget, 3, raw=TRUE))
> # modello polinomiale di decimo grado
> highPolyModelAgg <- lm(aggdata$Out ~ poly(aggdata$Budget, 10, raw=TRUE))
> # LOESS model ( local regression )
> loessModelAgg <- loess(aggdata$Out ~ aggdata$Budget,span=0.65)
> my.count <- seq(from=0, to=(length(aggdata[,1]))-1, by=1)
> pred <- predict(loessModelAgg,my.count,se=TRUE)
>
> # stampa informazioni relative ai modelli, tra cui misure come il coefficiente di determinazione e F-test
> summary(linearModelAgg)
> summary(quadraticModelAgg)
> #  ... 
\end{lstlisting}

Come spiegato nel paragrafo precedente sono stati calcolati anche i residuali per poi analizzarli tramite grafico di dispersione e successivamente è stata verificato se la distribuzione degli errori casuali fosse normale.

\begin{lstlisting}
> # calcolo dei valori residuali
> modelResidLinear=resid(linearModelAgg)
> modelResidQuadratic=resid(quadraticModelAgg)
> #  ...
> # traccia i grafici di dispersione dei residuali per i diversi modelli
> plot(aggdata$Budget,modelResidLinear,type="p",lwd=3,ylab="Residuals", xlab="Budget Fotovoltaico ( milioni di Euro )",xlim=c(0,40),main="Linear Model") 
> plot(aggdata$Budget,modelResidQuadratic,type="p",lwd=3,ylab="Residuals", xlab="Budget Fotovoltaico ( milioni di Euro )",xlim=c(0,40),main="Quadratic Model") 
> #  ...
> # calcolo errori casuali relativi ai modelli
> lmstdres=rstandard(linearModelAgg)
> qmstdres=rstandard(quadraticModelAgg)
> #  ...
> # confronto grafico tra errori casuali e la distribuzione normale
> qqnorm(lmstdres, ylab="Standardized Residuals", xlab="Normal Scores",main="Linear Model") 
> qqline(lmstdres)
> #  ...
\end{lstlisting}

Dopo aver scelto quale sia il modello di regressione che meglio si adatta ai dati, è immediato presentare graficamente i risultati ottenuti.

\begin{lstlisting}
> # traccia il grafico con i dati grezzi
> plot(data$Out ~ data$Budget,type="n",lwd=3,ylab="Produzione Energetica ( kW )", xlab="Budget Fotovoltaico ( milioni di Euro )",cex.lab=0.9,xlim=c(0,30))
> points(data$Out ~ data$Budget,col="blue4",pch=1)
> # traccia il grafico per il modello di regressione scelto; ovviamente consente anche di confrontare tra loro i diversi modelli per avere un riscontro visivo della loro correttezza
> plot(aggdata$Out ~ aggdata$Budget,type="p",lwd=3,ylab="Produzione Energetica ( kW )", xlab="Budget Fotovoltaico ( milioni di Euro )",xlim=c(0,60)) 
> grid(lwd=2)
> # modello lineare
> points(data$Budget, predict(linearModel), type="l", col="red", lwd=2)
> # modello LOESS
> lines(aggdata$Budget,pred$fit, lty="solid", col="darkred", lwd=2)
\end{lstlisting}

\section[ANALISI RISULTATI]{ANALISI RISULTATI SIMULAZIONI}

Dopo aver implementato il simulatore descritto nel precedente capitolo, considerando in particolar modo la versione estesa, siamo passati ad analizzare le relazioni che legano la produzione di energia elettrica alle diverse metodologie di incentivi e relativi fondi stanziati dalla regione. Possiamo subito anticipare che, come era lecito attendersi, la presenza di un qualsiasi tipo di incentivo permette di ottenere una produzione energetica maggiore rispetto al caso di assenza di incentivi regionali e inoltre all'aumentare dei fondi stanziati per finanziare un tipo di incentivo la produzione di energia da impianti fotovoltaici tende ad aumentare.\\*
In un secondo momento siamo passati a studiare la relazione tra produzione energetica e interazione sociale (considerando sia variazioni del raggio che della sensibilità); in modo conforme alle nostre aspettative, anche in questo caso i risultati ottenuti indicano che una maggiore produzione energetica è associata ad un'interazione sociale più intensa.


\subsection{COMPORTAMENTO DEGLI INCENTIVI}

Il comportamento degli incentivi è stato studiato effettuando numerose simulazioni per ogni tipo di incentivo, variando la dimensione del fondo dedicato agli incentivi per il fotovoltaico. Il fondo è stato aumentato con incrementi di un milione di euro a partire da zero  fino a un massimo di 40 milioni (considerando un arco temporale di cinque anni); per ogni valore sono state effettuate 300 simulazioni, per un totale di 48000 simulazioni considerando tutti i diversi incentivi.\\*
Proseguiremo ora esaminando i singoli incentivi per poi concludere confrontandoli tra loro.

\myparagraph{Fondo Asta}

In Figura ~\ref{graphSimA} sono riportati sia i risultati ottenuti da tutte le simulazioni effettuate con l'incentivo Fondo Asta (Fig.~\ref{graphSimA_R}), sia la linea di regressione associata al modello che meglio vi si adattasse (Fig.~\ref{regr_graphSimA_R}), rappresentato in questo caso da una funzione quadratica.

\begin{figure}[H]
	\centering
	\subfloat[Simulazioni]{\includegraphics[scale=0.55]{graphSimA_R}\label{graphSimA_R}}
	\qquad
	\subfloat[Relazione]{\includegraphics[scale=0.55]{regr_graphSimA_R}\label{regr_graphSimA_R}}
	\caption{Fondo Asta}
	\label{graphSimA}
\end{figure}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.8]{residualsPlot_A}
	\caption{Fondo Asta, analisi dei residuali}
	\label{residualsPlot_A}
\end{figure}

Osservando il grafico possiamo notare quindi che la produzione energetica aumenta insieme all'aumentare del budget dedicato all'incentivazione, con una relazione quasi lineare per valori minori di trenta milioni di euro per poi continuare ad aumentare ma ad un ritmo minore; ciò è dovuto probabilmente al fatto che si raggiunge una specie di ''saturazione'' nell'accesso agli incentivi, cioè quando la somma stanziata per il Fonda Asta raggiunge valori sufficienti è possibile fornire la percentuale sul costo di costruzione dell'impianto fotovoltaico a quasi tutti gli agenti che ne fanno richiesta, di conseguenza la produzione energetica inizia a crescere più lentamente.\\* \\*
In questo caso, come anche con gli altri incentivi, la scelta del modello di regressione corretto è stata fatta sulla base dei valori numerici presentati nel paragrafo precedente, cercando comunque di scegliere il modello più semplice a parità di miglioramenti non significativi nelle misure della bontà di adattamento ai dati. Per il questo tipo di incentivo la regressione quadratica ha fornito risultati molto buoni, con un coefficiente di determinazione pari a 0.907 e valori di p-value e F-test che garantiscono la significatività statistica.\\*
In Figura ~\ref{residualsPlot_A} sono mostrati i grafici di dispersione dei residuali (asse della ordinate) rispetto al budget (la variabile indipendente, sull'asse delle ascisse) per alcuni dei modelli tentati; risulta evidente un andamento caratteristico della distribuzione solamente nel caso del modello lineare, mentre nei modelli restanti la distribuzione è molto simile e non strutturata, a indicare una maggiore adesione della regressione ai dati sottostanti.\\* \\*
In Figura ~\ref{normProbPlot_A} abbiamo infine presentato i grafici della distribuzione degli errori (rappresentati dai cerchi neri) di alcuni modelli, per confrontarli con una distribuzione normale standard (la retta). Come è facile osservare per tutti i modelli la distribuzione degli errori casuali segue piuttosto fedelmente una distribuzione normale, consentendoci di considerare vera l'assunzione di normalità; dal momento che questo avviene anche per tutti le restanti metodologie incentivanti, nei casi restanti, per non appesantire la trattazione, non abbiamo riportato ulteriori grafici di quest'ultimo tipo. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.8]{normProbPlot_A}
	\caption{Fondo Asta, distribuzione errori}
	\label{normProbPlot_A}
\end{figure}

\myparagraph{Conto Interessi}

L'incentivo Conto Interessi (Fig.~\ref{graphSimCI}) mostra un andamento decisamente diverso rispetto al caso precedente, in quanto dopo una crescita molto veloce la produzione energetica si stabilizza e non aumenta a prescindere da quanto venga speso. \\* 

\begin{figure}[H]
	\centering
	\subfloat[Simulazioni]{\includegraphics[scale=0.55]{graphSimCI_R}\label{graphSimCI_R}}
	\qquad
	\subfloat[Relazione]{\includegraphics[scale=0.55]{regr_graphSimCI_R}\label{regr_graphSimCI_R}}
	\caption{Conto Interessi}
	\label{graphSimCI}
\end{figure}

Questo comportamento è in linea con quanto era lecito attendersi poiché il Conto Interessi è ampiamente la tipologia di incentivazione che richiede meno fondi e una volta che tutti i richiedenti sono stati soddisfatti, per un costo di circa tre milioni di euro, ulteriori aumenti di budget non corrispondono ad aumenti della produzione.

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.8]{residualsPlot_CI}
	\caption{Conto Interessi, analisi dei residuali}
	\label{residualsPlot_CI}
\end{figure}

La tipologia di regressione che meglio approssima il comportamento di questo incentivo è costituita da una funzione polinomiale di grado elevato (in particolare il decimo), caratterizzato da un coefficiente di determinazione di 0.901; come in quello precedente in questo caso p-value e F-test garantiscono un'ottima significatività statistica.\\* 
Anche dalla Figura ~\ref{residualsPlot_CI} si può notare come l'analisi grafica dei residuali suggerisca che il metodo di regressione migliore sia quello scelto, infatti nei restanti modelli è facilmente riscontrabile una struttura non casuale.

\myparagraph{Fondo Rotazione}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.8]{residualsPlot_R}
	\caption{Fondo Rotazione, analisi dei residuali}
	\label{residualsPlot_R}
\end{figure}

\begin{figure}[H]
	\centering
	\subfloat[Simulazioni]{\includegraphics[scale=0.55]{graphSimR_R}\label{graphSimR_R}}
	\qquad
	\subfloat[Relazione]{\includegraphics[scale=0.55]{regr_graphSimR_R}\label{regr_graphSimR_R}}
	\caption{Fondo Rotazione}
	\label{graphSimR}
\end{figure}

La situazione nel caso del Fondo Rotazione (Fig.~\ref{graphSimR}) è simile a quella del Fondo Asta, infatti anche in questo caso il modello di regressione migliore è dato da una funzione quadratica (ancora con ottima significatività statistica e un coefficiente di determinazione pari a 0.983), con la differenza che la crescita della produzione in relazione ai finanziamenti resta più marcata anche per valori di budget più elevati e la pendenza della curva diminuisce più lentamente.\\*
Allo stesso modo la Figura ~\ref{residualsPlot_R} mostra come la distribuzione dei residuali per il modello scelto sia indicativa di un ottimo adattamento ai dati.

\myparagraph{Fondo Garanzia}

Infine consideriamo il caso dell'incentivo Fondo Garanzia, mostrato in Figura ~\ref{graphSimG}. Si nota nuovamente un andamento contraddistinto inizialmente da un aumento della produzione energetica al crescere dei fondi messi a disposizione con una curva quasi lineare (fino a circa quindici milioni di euro), per poi osservare una stabilizzazione nella produzione energetica dopo che un certo valore di budget è stato raggiunto (circa venti milioni di euro), probabilmente, in maniera simile al Conto Interessi, anche con questa metodologia incentivante è possibile soddisfare quasi tutti i richiedenti con una spesa sensibilmente minore rispetto ai casi Asta e Rotazione.\\*\\*
Il modello di regressione che è risultato essere il più opportuno con i dati del Fondo Garanzia, è il cosiddetto LOESS (modello locale); per questo tipo di modello non è possibile riportare dati come il coefficiente di determinazione in quanto non produce una funzione di regressione facilmente rappresentabile tramite una formula matematica, ma in ogni caso il confronto con altri tipi di modelli sulla base di analisi di tipo grafico ci ha fatto propendere verso la sua scelta (anche se lo stesso modello polinomiale usato per il Conto Interessi aveva mostrato un buon adattamento ai dati).\\*
In Figura ~\ref{residualsPlot_G} è possibile vedere anche per il Fondo Garanzia quali siano i grafici di dispersione dei residuali per alcuni modelli di regressione, dalla cui osservazione si può dedurre che il modello LOESS sia stato una buona scelta.

\begin{figure}[H]
	\centering
	\subfloat[Simulazioni]{\includegraphics[scale=0.55]{graphSimG_R}\label{graphSimG_R}}
	\qquad
	\subfloat[Relazione]{\includegraphics[scale=0.55]{regr_graphSimG_R}\label{regr_graphSimG_R}}
	\caption{Fondo Garanzia}
	\label{graphSimG}
\end{figure}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.8]{residualsPlot_G}
	\caption{Fondo Garanzia, analisi dei residuali}
	\label{residualsPlot_G}
\end{figure}

\myparagraph{Confronto Incentivi}

Infine in Figura ~\ref{incentCompare} sono confrontati i differenti comportamenti dei vari incentivi. Si nota facilmente come il Conto Interessi sia il tipo di incentivo migliore per quasi tutto l'intervallo considerato per il budget (che possiamo ritenere sensato in quanto compatibile con gli investimenti realmente effettuati dalla regione), leggermente superato dal Fondo Rotazione solamente con un fondo incentivi maggiore di quaranta milioni di euro. Il Fondo Garanzia e il Fondo Rotazione hanno un andamento equiparabile per finanziamenti non elevati, ma il secondo si comporta decisamente meglio in caso di forti investimenti (occorre comunque ricordare che in questo grafico non viene tenuto conto di quanta parte di budget viene effettivamente consumata dall'incentivo, fattore che viene invece considerato nella valutazione dell'efficacia impiegata nel modello a vincoli del problema). Il Fondo Asta risulta essere la metodologia di incentivo meno efficiente per la produzione di energia elettrica.

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.65]{incentCompare}
	\caption{Confronto tra i diversi incentivi}
	\label{incentCompare}
\end{figure}

\subsection{EFFETTI DELL'INTERAZIONE SOCIALE}

Gli effetti dell'iterazione sociale sulla produzione energetica sono stati studiati agendo sui due parametri che possono influenzarla, il raggio dell'interazione (misurato in patches) e la sensibilità all'influenza (adimensionale) derivante dal comportamento dei vicini, ed effettuando numerose simulazioni controllate: per ricavare la relazione tra produzione energetica e raggio questo è stato fatto variare da 1 fino a 40 (valori espressi con un'unità di misura interna al simulatore, la patch del mondo virtuale), con incrementi di una un'unità e 200 prove per valore, per un totale di 32000 simulazioni; per la relazione tra produzione e sensibilità questa è stata fatta crescere da 0 fino a 20 a intervalli di 0.5, ancora con un totale di 32000 simulazioni.

\myparagraph{Sensibilità a interazione}

In questo paragrafo verranno mostrate le relazioni che legano la sensibilità degli agenti nei confronti dell'interazione sociale e la produzione energetica, distinguendo i quattro tipi di incentivi. Per ogni tipologia è stata effettuata un'analisi della regressione analoga a quelle effettuate in precedenza e, per maggiore concisione, esaminiamo ora direttamente i risultati ottenuti con il modello di regressione da noi ritenuto migliore, senza riportare i passaggi che ci hanno permesso di stabilire quale fosse (coefficiente di determinazione, analisi grafica dei residuali,...); il modello da noi scelto in quanto miglior approssimazione dei dati è stato quello LOESS, anche se la regressione con una funzione polinomiale di alto grado presentava una bontà di adattamento pressoché identica.\\* \\*
Osserviamo che  la produzione energetica è positivamente correlata all'incremento della sensibilità all'influenza sociale. Si possono notare alcune somiglianze nell'andamento delle curve di regressione dei Fondi Asta e Rotazione (Fig.~\ref{graphAsocS} e Fig.~\ref{graphRsocS}), infatti in entrambi i casi dopo una relazione quasi lineare per valori della sensibilità inferiori a 10, si nota una leggera diminuzione della pendenza della curva. \\*

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{graphSimA_socS}
	\caption{Fondo Asta, sensibilità a influenza sociale}
	\label{graphAsocS}
\end{figure}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.5]{graphSimCI_socS}
	\caption{Conto Interessi, sensibilità a influenza sociale}
	\label{graphCIsocS}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{graphSimR_socS}
	\caption{Fondo Rotazione, sensibilità a influenza sociale}
	\label{graphRsocS}
\end{figure}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.5]{graphSimG_socS}
	\caption{Fondo Garanzia, sensibilità a influenza sociale}
	\label{graphGsocS}
\end{figure}

Nel caso del Conto Interessi e Fondo Garanzia (Fig.~\ref{graphCIsocS} e Fig.~\ref{graphGsocS}) la linea di regressione presenta un comportamento più irregolare (specialmente nel caso del Fondo Garanzia) e sembra suggerire che aumentando la sensibilità oltre al valore 20 la corrispondente produzione energetica diminuisca, ma questa inversione di tendenza è apparente e con ulteriori simulazioni abbiamo provato che la funzione continua ad essere crescente, anche se poco e con notevoli oscillazioni, per valori di sensibilità maggiori.

\myparagraph{Raggio dell'interazione}

Come nel caso della sensibilità, anche per valutare la relazione tra produzione energetica e raggio dell'iterazione sociale abbiamo applicato i metodi di analisi della regressione visti in precedenza, quindi anche in questo caso abbiamo riportato direttamente i risultati con il modello migliore; la scelta è ricaduta nuovamente sul modello LOESS, nonostante la buona approssimazione fornita anche dal modello polinomiale (uno dei motivi che ci ha fatto propendere verso la nostra scelta è il fatto che una funzione di regressione definita da un polinomio di grado elevato fosse troppo sensibile alla presenza di valori anomali, outliers, e presentasse quindi un andamento più irregolare).\\* \\*
Per tutti tipi di incentivo possiamo osservare che la produzione energetica è positivamente correlata all'incremento del raggio dell'iterazione sociale, in particolare fino a un certo valore di raggio l'aumento di quest'ultimo provoca un rapido miglioramento della produzione, ma oltre tale valore la produzione incrementa più moderatamente; in ogni caso, pur con le dovute differenze tra le pendenze, le curve dei vari incentivi indicano che l'interazione sociale è influenzata maggiormente dall'aumento del raggio piuttosto che dalla sensibilità ad essa, anche se entrambi i fattori concorrono ad aumentare l'effetto positivo dell'interazione stessa (può essere utile anche notare che un un valore di 40 patches per il raggio in un mondo virtuale a forma di quadrato di lato 60 patches è chiaramente un valore non riscontrabile nel mondo reale).
%-------------> raggio iterazion 40 è grande

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{graphSimA_socR}
	\caption{Fondo Asta, sensibilità a raggio interazione}
	\label{graphAsocR}
\end{figure}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.5]{graphSimCI_socR}
	\caption{Conto Interessi, sensibilità a raggio interazione}
	\label{graphCIsocR}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{graphSimR_socR}
	\caption{Fondo Rotazione, sensibilità a raggio interazione}
	\label{graphRsocR}
\end{figure}

\begin{figure}[hbt]
	\centering
	\includegraphics[scale=0.5]{graphSimG_socR}
	\caption{Fondo Garanzia, sensibilità a raggio interazione}
	\label{graphGsocR}
\end{figure}


\nocite{*}
\bibliographystyle{plain}
\bibliography{bibliography}

\end{document}
